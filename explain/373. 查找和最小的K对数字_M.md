---
title: 373. æŸ¥æ‰¾å’Œæœ€å°çš„Kå¯¹æ•°å­—_M
created: 2025-01-05
tags:
  - éš¾åº¦/ä¸­ç­‰
  - æ•°æ®ç»“æ„/å †
  - æ•°æ®ç»“æ„/æ•°ç»„
  - ä¸»é¢˜/äºŒåˆ†æŸ¥æ‰¾
  - ä¸»é¢˜/é“¾è¡¨åˆå¹¶
---

#### [373. æŸ¥æ‰¾å’Œæœ€å°çš„Kå¯¹æ•°å­—](https://leetcode-cn.com/problems/find-k-pairs-with-smallest-sums/)

éš¾åº¦ï¼šä¸­ç­‰

æ ‡ç­¾ï¼š[æ•°ç»„](../åŸç†/æ•°ç»„.md)ï¼Œ[å †](../åŸç†/å †.md)

ç›¸åŒé¢˜ç›®ï¼š[å‰‘æŒ‡ Offer II 061. å’Œæœ€å°çš„ k ä¸ªæ•°å¯¹](https://leetcode-cn.com/problems/qn8gGX/)

ç»™å®šä¸¤ä¸ªä»¥**éé€’å‡é¡ºåºæ’åˆ—**æ’åˆ—çš„æ•´æ•°æ•°ç»„ nums1 å’Œ nums2Â ,Â ä»¥åŠä¸€ä¸ªæ•´æ•° kÂ ã€‚

å®šä¹‰ä¸€å¯¹å€¼Â (u,v)ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ¥è‡ªÂ nums1ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ¥è‡ª nums2Â ã€‚

è¯·æ‰¾åˆ°å’Œæœ€å°çš„ kÂ ä¸ªæ•°å¯¹Â (u1,v1), Â (u2,v2) Â ... Â (uk,vk)Â ã€‚

Â 

ç¤ºä¾‹ 1:

è¾“å…¥: nums1 = [1,7,11], nums2 = [2,4,6], k = 3
è¾“å‡º: [1,2],[1,4],[1,6]
è§£é‡Š: è¿”å›åºåˆ—ä¸­çš„å‰ 3 å¯¹æ•°ï¼š
     [1,2],[1,4],[1,6],[7,2],[7,4],[11,2],[7,6],[11,4],[11,6]
ç¤ºä¾‹ 2:

è¾“å…¥: nums1 = [1,1,2], nums2 = [1,2,3], k = 2
è¾“å‡º: [1,1],[1,1]
è§£é‡Š: è¿”å›åºåˆ—ä¸­çš„å‰ 2 å¯¹æ•°ï¼š
Â     [1,1],[1,1],[1,2],[2,1],[1,2],[2,2],[1,3],[1,3],[2,3]
ç¤ºä¾‹ 3:

è¾“å…¥: nums1 = [1,2], nums2 = [3], k = 3 
è¾“å‡º: [1,3],[2,3]
è§£é‡Š: ä¹Ÿå¯èƒ½åºåˆ—ä¸­æ‰€æœ‰çš„æ•°å¯¹éƒ½è¢«è¿”å›:[1,3],[2,3]


æç¤º:

1 <= nums1.length, nums2.length <= 10^4
-10^9 <= nums1[i], nums2[i] <= 10^9
nums1, nums2 å‡ä¸ºå‡åºæ’åˆ—
1 <= k <= 1000

## æ€è·¯

è¿™é“é¢˜å…¶å®æ˜¯Â [23. åˆå¹¶Kä¸ªå‡åºé“¾è¡¨](https://leetcode.cn/problems/merge-k-sorted-lists)Â çš„å˜ä½“ã€‚

æ€ä¹ˆæŠŠè¿™é“é¢˜å˜æˆåˆå¹¶å¤šä¸ªæœ‰åºé“¾è¡¨å‘¢ï¼Ÿå°±æ¯”å¦‚è¯´é¢˜ç›®è¾“å…¥çš„ç”¨ä¾‹ï¼š

```
nums1 = [1,7,11], nums2 = [2,4,6]
```

ç»„åˆå‡ºçš„æ‰€æœ‰æ•°å¯¹å„¿è¿™å°±å¯ä»¥æŠ½è±¡æˆä¸‰ä¸ªæœ‰åºé“¾è¡¨ï¼š

```
[1, 2] -> [1, 4] -> [1, 6]
[7, 2] -> [7, 4] -> [7, 6]
[11, 2] -> [11, 4] -> [11, 6]
```

è¿™ä¸‰ä¸ªé“¾è¡¨ä¸­æ¯ä¸ªå…ƒç´ ï¼ˆæ•°å¯¹ä¹‹å’Œï¼‰æ˜¯é€’å¢çš„ï¼Œæ‰€ä»¥å°±å¯ä»¥æŒ‰ç…§Â [23. åˆå¹¶Kä¸ªå‡åºé“¾è¡¨](https://leetcode.cn/problems/merge-k-sorted-lists)Â çš„æ€è·¯æ¥åˆå¹¶ï¼Œå–å‡ºå‰Â `k`Â ä¸ªä½œä¸ºç­”æ¡ˆå³å¯ã€‚

```python
# æ³¨æ„ï¼špython ä»£ç ç”± chatGPTğŸ¤– æ ¹æ®æˆ‘çš„ java ä»£ç ç¿»è¯‘ã€‚
# æœ¬ä»£ç çš„æ­£ç¡®æ€§å·²é€šè¿‡åŠ›æ‰£éªŒè¯ï¼Œå¦‚æœ‰ç–‘é—®ï¼Œå¯ä»¥å¯¹ç…§ java ä»£ç æŸ¥çœ‹ã€‚

from queue import PriorityQueue

class Solution:
    def kSmallestPairs(self, nums1: List[int], nums2: List[int], k: int) -> List[List[int]]:
        # å­˜å‚¨ä¸‰å…ƒç»„ (num1[i], nums2[i], i)
        # i è®°å½• nums2 å…ƒç´ çš„ç´¢å¼•ä½ç½®ï¼Œç”¨äºç”Ÿæˆä¸‹ä¸€ä¸ªèŠ‚ç‚¹
        pq = PriorityQueue()
        
        # æŒ‰ç…§ 23 é¢˜çš„é€»è¾‘åˆå§‹åŒ–ä¼˜å…ˆçº§é˜Ÿåˆ—
        for i in range(len(nums1)):
            pq.put((nums1[i] + nums2[0], nums1[i], nums2[0], 0))

        res = []
        # æ‰§è¡Œåˆå¹¶å¤šä¸ªæœ‰åºé“¾è¡¨çš„é€»è¾‘
        while not pq.empty() and k > 0:
            _, num1, num2, idx = pq.get()
            k -= 1
            # é“¾è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹åŠ å…¥ä¼˜å…ˆçº§é˜Ÿåˆ—
            next_index = idx + 1
            if next_index < len(nums2):
                pq.put((num1 + nums2[next_index], num1, nums2[next_index], next_index))

            # æŒ‰ç…§æ•°å¯¹çš„å…ƒç´ å’Œå‡åºæ’åº
            pair = [num1, num2]
            res.append(pair)

        return res
```

#### æœ€å¤§å †

å¯ä»¥ç”¨æœ€å¤§å †æ¥å­˜å‚¨è¿™kä¸ªå’Œæœ€å°çš„æ•°å¯¹ã€‚é€ä¸€å°†mÃ—nä¸ªæ•°å¯¹æ·»åŠ åˆ°æœ€å¤§å †ä¸­ã€‚

é¢˜ç›®ç»™å‡ºçš„æ¡ä»¶æ˜¯è¾“å…¥çš„ä¸¤ä¸ªæ•°ç»„éƒ½æ˜¯é€’å¢æ’åºçš„ã€‚ä¸ç®¡è¾“å…¥çš„æ•°ç»„nums1æœ‰å¤šé•¿ï¼Œæœ€å¤šåªéœ€è¦è€ƒè™‘å‰kä¸ªæ•°å­—ã€‚åŒç†ï¼Œä¸ç®¡è¾“å…¥çš„æ•°ç»„nums2æœ‰å¤šé•¿ï¼Œæœ€å¤šä¹Ÿåªéœ€è¦è€ƒè™‘å‰kä¸ªæ•°å­—ã€‚



```python
class Solution:
    def kSmallestPairs(self, nums1: List[int], nums2: List[int], k: int) -> List[List[int]]:
        heap = []
        # å®˜æ–¹å®ç°çš„æ˜¯æœ€å°å †ï¼Œè‹¥æƒ³å®ç°æœ€å¤§å †ï¼Œä»…éœ€è¦å°†æ¯ä¸ªå…ƒç´ çš„ é”® å€¼æ·»è´Ÿå·ã€‚
        for a in nums1:
            for b in nums2:
                if len(heap) < k:
                    heapq.heappush(heap, (-(a + b), [a, b]))
                elif -(a + b) > heap[0][0]:
                    heapq.heappushpop(heap, (-(a + b), [a, b]))
                else:
                    break
        ans = []
        while heap:
            t = heapq.heappop(heap, )
            ans.append(t[1])
        ans.reverse()
        return ans
```

ä¸Šè¿°ä»£ç æœ‰ä¸¤ä¸ªç›¸äº’åµŒå¥—çš„forå¾ªç¯ï¼Œæ¯ä¸ªå¾ªç¯æœ€å¤šæ‰§è¡Œkæ¬¡ã€‚åœ¨å¾ªç¯ä½“å†…å¯èƒ½åœ¨æœ€å¤§å †ä¸­è¿›è¡Œæ·»åŠ æˆ–åˆ é™¤æ“ä½œï¼Œç”±äºæœ€å¤§å †ä¸­æœ€å¤šåŒ…å«kä¸ªå…ƒç´ ï¼Œå› æ­¤æ·»åŠ ã€åˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚éƒ½æ˜¯Oï¼ˆlogkï¼‰ã€‚è¿™ä¸¤ä¸ªforå¾ªç¯çš„æ—¶é—´å¤æ‚åº¦æ˜¯Oï¼ˆk^2logkï¼‰ã€‚å¦å¤–ï¼Œä¸Šè¿°ä»£ç è¿˜æœ‰ä¸€ä¸ªwhileå¾ªç¯ï¼Œå®ƒé€ä¸€ä»æœ€å¤§å †ä¸­åˆ é™¤å…ƒç´ å¹¶å°†å¯¹åº”çš„æ•°å¯¹æ·»åŠ åˆ°é“¾è¡¨ä¸­ï¼Œè¿™ä¸ªwhileå¾ªç¯çš„æ—¶é—´å¤æ‚åº¦æ˜¯Oï¼ˆklogkï¼‰ã€‚å› æ­¤ï¼Œä¸Šè¿°ä»£ç æ€»çš„æ—¶é—´å¤æ‚åº¦æ˜¯Oï¼ˆk^2logkï¼‰ã€‚

#### æœ€å°å †

å‰‘æŒ‡offer

å¦‚æœè¾“å…¥ä¸¤ä¸ªæ•°ç»„[1ï¼Œ5ï¼Œ13ï¼Œ21]å’Œ[2ï¼Œ4ï¼Œ9ï¼Œ15]æ±‚å–å’Œæœ€å°çš„3ä¸ªæ•°å¯¹ï¼Œé‚£ä¹ˆå…ˆä»ç¬¬1ä¸ªæ•°ç»„ä¸­é€‰å–æœ€å‰é¢çš„3ä¸ªæ•°å­—1ã€5ã€13ï¼Œå®ƒä»¬åˆ†åˆ«å’Œç¬¬2ä¸ªæ•°ç»„çš„ç¬¬1ä¸ªæ•°å­—2ç»„æˆ3ä¸ªæ•°å¯¹ï¼ˆ1ï¼Œ2ï¼‰ã€ï¼ˆ5ï¼Œ2ï¼‰ã€ï¼ˆ13ï¼Œ2ï¼‰ã€‚è¿™3ä¸ªå€™é€‰çš„æ•°å¯¹ä¸­å’Œæœ€å°çš„æ•°å¯¹ä¸ºï¼ˆ1ï¼Œ2ï¼‰ã€‚

æ‰¾å‡ºï¼ˆ1ï¼Œ2ï¼‰è¿™ä¸ªå’Œæœ€å°çš„æ•°å¯¹ä¹‹åï¼Œæ¥ç€æ‰¾ä¸‹ä¸€ä¸ªå’Œæœ€å°çš„æ•°å¯¹ã€‚ç”±äºæ•°å¯¹ï¼ˆ1ï¼Œ2ï¼‰çš„ä¸¤ä¸ªæ•°å­—1å’Œ2åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­çš„ä¸‹æ ‡éƒ½æ˜¯0ï¼Œå› æ­¤ä¸‹ä¸€ä¸ªå’Œæœ€å°çš„æ•°å¯¹æ—¢å¯èƒ½æ˜¯ç”±ç¬¬1ä¸ªæ•°ç»„ä¸­ä¸‹æ ‡ä¸º0å’Œç¬¬2ä¸ªæ•°ç»„ä¸­ä¸‹æ ‡ä¸º1çš„ä¸¤ä¸ªæ•°å­—ç»„æˆçš„ï¼Œå³æ•°å¯¹ï¼ˆ1ï¼Œ4ï¼‰ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”±ç¬¬1ä¸ªæ•°ç»„ä¸­ä¸‹æ ‡ä¸º1å’Œç¬¬2ä¸ªæ•°ç»„ä¸­ä¸‹æ ‡ä¸º0çš„ä¸¤ä¸ªæ•°å­—ç»„æˆçš„ï¼Œå³æ•°å¯¹ï¼ˆ5ï¼Œ2ï¼‰ã€‚æ•°å¯¹ï¼ˆ5ï¼Œ2ï¼‰å·²ç»åœ¨å€™é€‰çš„æ•°å¯¹ä¸­ï¼Œæ‰€ä»¥åœ¨å€™é€‰çš„æ•°å¯¹ä¸­æ·»åŠ æ•°å¯¹ï¼ˆ1ï¼Œ4ï¼‰å³å¯ã€‚å°†è¿™ä¸ªæ–°æ·»åŠ çš„æ•°å¯¹ä¸å‰ä¸€ä¸ªå’Œæœ€å°çš„æ•°å¯¹ï¼ˆ1ï¼Œ2ï¼‰è¿›è¡Œæ¯”è¾ƒå¯ä»¥å‘ç°ï¼Œå®ƒä»¬çš„ç¬¬1ä¸ªæ•°å­—æ˜¯ç›¸åŒçš„ï¼Œä½†ç¬¬2ä¸ªæ•°å­—åœ¨ç¬¬2ä¸ªæ•°ç»„ä¸­ä¸‹æ ‡å¢åŠ äº†1ã€‚åœ¨3ä¸ªå€™é€‰çš„æ•°å¯¹ï¼ˆ1ï¼Œ4ï¼‰ã€ï¼ˆ5ï¼Œ2ï¼‰ã€ï¼ˆ13ï¼Œ2ï¼‰ä¸­å’Œæœ€å°çš„æ•°å¯¹æ˜¯ï¼ˆ1ï¼Œ4ï¼‰ã€‚

æ•°å¯¹ï¼ˆ1ï¼Œ4ï¼‰çš„ä¸¤ä¸ªæ•°å­—1å’Œ4åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­çš„ä¸‹æ ‡åˆ†åˆ«ä¸º0å’Œ1ã€‚æ¥ä¸‹æ¥å°†ç”±ç¬¬1ä¸ªæ•°ç»„ä¸­ä¸‹æ ‡ä¸º0çš„æ•°å­—å’Œç¬¬2ä¸ªæ•°ç»„ä¸­ä¸‹æ ‡ä¸º2çš„æ•°å­—ç»„æˆçš„æ•°å¯¹ï¼ˆ1ï¼Œ9ï¼‰æ·»åŠ åˆ°å€™é€‰æ•°å¯¹ä¸­ã€‚3ä¸ªå€™é€‰æ•°å¯¹ï¼ˆ1ï¼Œ9ï¼‰ã€ï¼ˆ5ï¼Œ2ï¼‰ã€ï¼ˆ13ï¼Œ2ï¼‰ä¸­å’Œæœ€å°çš„æ•°å¯¹æ˜¯ï¼ˆ5ï¼Œ2ï¼‰ã€‚

ï¼ˆaï¼‰åœ¨ï¼ˆ1ï¼Œ2ï¼‰ã€ï¼ˆ5ï¼Œ2ï¼‰ã€ï¼ˆ13ï¼Œ2ï¼‰è¿™3ä¸ªæ•°å¯¹ä¸­é€‰å‡ºå’Œæœ€å°çš„æ•°å¯¹ï¼ˆ1ï¼Œ2ï¼‰ï¼›ï¼ˆbï¼‰åœ¨ï¼ˆ1ï¼Œ4ï¼‰ã€ï¼ˆ5ï¼Œ2ï¼‰ã€ï¼ˆ13ï¼Œ2ï¼‰è¿™3ä¸ªæ•°å¯¹ä¸­é€‰å‡ºå’Œæœ€å°çš„æ•°å¯¹ï¼ˆ1ï¼Œ4ï¼‰ï¼›ï¼ˆcï¼‰åœ¨ï¼ˆ1ï¼Œ9ï¼‰ã€ï¼ˆ5ï¼Œ2ï¼‰ã€ï¼ˆ13ï¼Œ2ï¼‰è¿™3ä¸ªæ•°å¯¹ä¸­é€‰å‡ºå’Œæœ€å°çš„æ•°å¯¹ï¼ˆ2ï¼Œ5ï¼‰

ç”±äºæ¯æ¬¡éƒ½æ˜¯ä»3ä¸ªå€™é€‰çš„æ•°å¯¹ä¸­é€‰å–å’Œæœ€å°çš„æ•°å¯¹ï¼Œå› æ­¤å¯ä»¥ç”¨ä¸€ä¸ªæœ€å°å †æ¥å­˜å‚¨å€™é€‰çš„æ•°å¯¹ã€‚å¦‚æœå’Œæœ€å°çš„æ•°å¯¹çš„ä¸¤ä¸ªæ•°å­—åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­çš„ä¸‹æ ‡åˆ†åˆ«ä¸ºi1å’Œi2ï¼Œå°†è¯¥æ•°å¯¹æ·»åŠ åˆ°ç»“æœä¸­å¹¶å°†å…¶ä»æœ€å°å †ä¸­åˆ é™¤ï¼Œå†å°†åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­ä¸‹æ ‡åˆ†åˆ«ä¸ºi1å’Œi2+1çš„ä¸¤ä¸ªæ•°å­—ä½œä¸ºæ–°çš„å€™é€‰æ•°å¯¹æ·»åŠ åˆ°æœ€å°å †ä¸­ã€‚

```python
class Solution:
    def kSmallestPairs(self, nums1: List[int], nums2: List[int], k: int) -> List[List[int]]:
        heap = []
        # æœ€å°å †ï¼Œé€‰å‡ºå€™é€‰ä¸­æœ€å°çš„æ•°å¯¹
        if len(nums2) > 0:
            for i, a in enumerate(nums1[:k]):
                heapq.heappush(heap, (nums1[i]+nums2[0],i, 0))
        result = []
        while k > 0 and heap:
            t = heapq.heappop(heap)
            result.append([nums1[t[1]], nums2[t[2]]])
            k -= 1
            if t[2] < len(nums2)-1:
                heapq.heappush(heap, (nums1[t[1]]+nums2[t[2]+1],t[1], t[2]+1))
        return result
```



ä¸Šè¿°ä»£ç å…ˆç”¨ä¸€ä¸ªforå¾ªç¯æ„å»ºä¸€ä¸ªå¤§å°ä¸ºkçš„æœ€å°å †ï¼Œè¯¥å¾ªç¯çš„æ—¶é—´å¤æ‚åº¦æ˜¯Oï¼ˆklogkï¼‰ã€‚æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªæ‰§è¡Œkæ¬¡çš„whileå¾ªç¯ï¼Œæ¯æ¬¡å¯¹å¤§å°ä¸ºkçš„æœ€å°å †è¿›è¡Œæ·»åŠ æˆ–åˆ é™¤æ“ä½œï¼Œå› æ­¤è¿™ä¸ªwhileå¾ªç¯çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯Oï¼ˆklogkï¼‰ã€‚ä¸Šè¿°ä»£ç æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸ºOï¼ˆklogkï¼‰ã€‚

```python
class Solution:
    def kSmallestPairs(self, nums1: List[int], nums2: List[int], k: int) -> List[List[int]]:
        m, n = len(nums1), len(nums2)
        ans = []
        pq = [(nums1[i] + nums2[0], i, 0) for i in range(min(k, m))]
        while pq and len(ans) < k:
            _, i, j = heappop(pq)
            ans.append([nums1[i], nums2[j]])
            if j + 1 < n:
                heappush(pq, (nums1[i] + nums2[j + 1], i, j + 1))
        return ans

ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£
é“¾æ¥ï¼šhttps://leetcode.cn/problems/find-k-pairs-with-smallest-sums/solutions/1208350/cha-zhao-he-zui-xiao-de-kdui-shu-zi-by-l-z526/
æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
```

äºŒåˆ†æŸ¥æ‰¾

```python
class Solution:
    def kSmallestPairs(self, nums1: List[int], nums2: List[int], k: int) -> List[List[int]]:
        m, n = len(nums1), len(nums2)

        # äºŒåˆ†æŸ¥æ‰¾ç¬¬ k å°çš„æ•°å¯¹å’Œ
        left, right = nums1[0] + nums2[0], nums1[m - 1] + nums2[n - 1] + 1
        while left < right:
            mid = (left + right) // 2
            cnt = 0
            i, j = 0, n - 1
            while i < m and j >= 0:
                if nums1[i] + nums2[j] > mid:
                    j -= 1
                else:
                    cnt += j + 1
                    i += 1
            if cnt < k:
                left = mid + 1
            else:
                right = mid
        pairSum = left

        ans = []
        # æ‰¾æ•°å¯¹å’Œå°äº pairSum çš„æ•°å¯¹
        i = n - 1
        for num1 in nums1:
            while i >= 0 and num1 + nums2[i] >= pairSum:
                i -= 1
            for j in range(i + 1):
                ans.append([num1, nums2[j]])
                if len(ans) == k:
                    return ans

        # æ‰¾æ•°å¯¹å’Œç­‰äº pairSum çš„æ•°å¯¹
        i = n - 1
        for num1 in nums1:
            while i >= 0 and num1 + nums2[i] > pairSum:
                i -= 1
            j = i
            while j >= 0 and num1 + nums2[j] == pairSum:
                ans.append([num1, nums2[j]])
                if len(ans) == k:
                    return ans
                j -= 1
        return ans

ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£
é“¾æ¥ï¼šhttps://leetcode.cn/problems/find-k-pairs-with-smallest-sums/solutions/1208350/cha-zhao-he-zui-xiao-de-kdui-shu-zi-by-l-z526/
æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
```